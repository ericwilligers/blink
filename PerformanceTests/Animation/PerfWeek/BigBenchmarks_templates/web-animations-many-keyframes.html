<!doctype html>
<meta name="viewport" content="width=device-width, user-scalable=no">
<container id="container"></container>
<script>
var N = {{NUM_ELEMENTS}};
var numKeyframes = 500;
var duration = 4000;

function makeKeyframes(numKeyframes, width, height) {
    var keyframes = [];
    for (var i = 0; i < numKeyframes + 1; i++) {
        var fraction = i / numKeyframes;
        var t = fraction * 2 * Math.PI;
        var x = Math.cos(t) - Math.pow(Math.cos(4*t), 3);
        x = ((x/4 + 1/2) * width).toFixed(5);
        var y = Math.pow(Math.sin(4*t), 3) - Math.sin(2*t);
        y = ((y/4 + 1/2) * height).toFixed(5);
        keyframes.push({transform: 'translate(' + x + 'px, ' + y + 'px)'});
    }
    return keyframes;
}

var keyframes = makeKeyframes(numKeyframes, 550, 800);
for (var i = 0; i < N; i++) {
  var target = document.createElement('target');
  container.appendChild(target);
  target.animate(keyframes, {duration: duration, iterations: Infinity, delay: -duration/10 * i/N});
}

requestAnimationFrame(function() {
  measurementReady = true;
});
</script>

<style>
body {
  margin: 0;
  overflow: hidden;
}
target {
  position: absolute;
  border: 5px solid green;
  border-radius: 100%;
}
container {
  position: absolute;
  width: 550px;
  height: 800px;
  background-color: lightgrey;
}
</style>
